# Приложение для анализа банковский операций
Приложение генерирует JSON-ответы для веб-страниц, осуществляет простой поиск по списку 
транзакций из EXCEL файла, выводит топ-5 транзакиций за период. Статус разработки: в разработке(после принятия курсовой 
работы - статус поменяется). Процент покрытия = 80+%.
## Содержание
Структура содержит пакет src , пакет tests артефакты poetry.
В пакете src реализован основной функционал данного проекта. Основная функция запуска, которая объединяет
работу доп. функций располагается в модуле main.py. 
Модуль utils (вложенные в него функции) осуществляют следующий функционал:
1) Чтение данных из Excel файла
2) Получение приветствия в зависимости от времени суток
3) Обработка данных по картам
4) Получение топ-5 транзакций по сумме платежа
5) Получение курсов валют
6) Получение цен акций
7) Загрузка пользовательских настроек из JSON файла
8) Определяет пути к файлам настроек и операциям
9) Преобразует строку даты в объект datetime

Модуль reports (вложенные в него функции) осуществляют следующий функционал:
1) Декоратор для логирования результата выполнения функции и записи его в JSON-файл
2) Вычисляет общие траты по заданной категории за последние три месяца до указанной даты. 
Если год, месяц или день не указаны, запрашивает их у пользователя.

Модуль services (вложенные в него функции) осуществляют следующий функионал:
1) Запрашивает год и месяц для анализа, анализирует суммы кешбэка по категориям на основе данных из Excel,
    исключая заранее определенные категории.
2) Ищет транзакции по запросу в описании или категории.

Модуль views (вложенные в него функции) осуществляют следующий функционал:
1) Основная функция страницы «Главная», берет данные с utils.py


## Использование
Скачать проект можно через публичный git: https://github.com/KirsanV/ProjectOne

## Разработка
Пример работы функции main.py:
1) Функция просит на вход дату в формате гггг-мм-дд чч:мм:сс
2) На выходе получаем JSON - ответ в формате `{"greeting": "Доброй ночи", "cards": [{"last_digits": "7197", "total_spent": -9600.71, "cashback": 96.01}], "top_transactions": [{"Дата операции": "02.05.2020", "Сумма платежа": -35.95, "Категория": "Супермаркеты", "Описание": "Магнит"}, {"Дата операции": "02.05.2020", "Сумма платежа": -2140.73, "Категория": "ЖКХ", "Описание": "ЖКУ Дом"}, {"Дата операции": "02.05.2020", "Сумма платежа": -2155.05, "Категория": "ЖКХ", "Описание": "ЖКУ Дом"}, {"Дата операции": "02.05.2020", "Сумма платежа": -9564.76, "Категория": "Другое", "Описание": "ГУП ВЦКП ЖХ"}], "currency_rates": [], "stock_prices": []}`
Вы можете заметить, что данных по конвертации валюты и акций нет, функция выдает пустой список - это связано с тем, 
что превышен лимит запросов на используемых ресурсах. Поэтому в функцию были добавлены логи, которые выдают сообщение
об ошибке в формате ERROR:root:`Ошибка при получении курсов валют: 429 - {"message":"You have exceeded your daily\/monthly API rate limit. Please review and upgrade your subscription plan at https:\/\/promptapi.com\/subscriptions to continue."}`
`ERROR:root:Ключ 'Time Series (1min)' отсутствует для AAPL. Ответ: {'Information': 'We have detected your API key as ????????? and our standard API rate limit is 25 requests per day.`
Чтобы избежать подобных исходов работы приложения приобретите подписку на сервис, либо пользуйтесь 
разными ресурсами.
3) После получения JSON ответа функция предлагает провести анализ кешбека.
`Введите год для анализа CashBack (например, 2021): 2021(<-пользовательский ввод)
Введите месяц для анализа CashBack (например, 12): 12(<-пользовательский ввод)`
4) Далее функция выдает наиболее выгодные категории кешбека: `Анализ кешбэка: {"Другое": 200.0, "ЖКХ": 142.1642, "Каршеринг": 74.6796}`
5) Функция предлагает ввести слово для поиска в транзакциях: `Введите слово для поиска в транзакциях: gsfd(<-пользовательский ввод)`
Если слово было найдено  - выводит список транзакций связанных с этим словом по всему excel файлу
Если слово найдено не было - выводит сообщение `Результаты поиска транзакций: {"message": "Такого слова не было обнаружено."}`
6) Далее функция предлагает проанализировать расходы по той или иной категории
`Введите категорию для анализа расходов:Аптеки
Введите год (например ,2020): 2020(<-пользовательский ввод)
Введите месяц (1-12): 12(<-пользовательский ввод)
Введите день (1-31): 31(<-пользовательский ввод)
Расходы по категории: {"category": "Аптеки", "total_spending": -7432.6, "date": "2020-12-31"}`

### Требования
Для установки и запуска проекта, свой уникальный API код(токен).
Пример констант указан в .env_template.

### Установка зависимостей
Список зависимостей располагается в файле requirements.txt

Для установки зависимостей, выполните команду:
```sh
$ npm i
```

## Тестирование
При тестировании использовался импорт  unittest: mock, patch; pytest; pandas


### Назначение проекта
Проект был разработан в рамках курсовой работы "Проект 1"

## Команда проекта
Студент академии skypro - K.Sh.
